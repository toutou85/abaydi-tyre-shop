
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>نموذج طلب إطار</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 20px; }
    form { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    input, select, textarea { width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc; }
    button { background: #28a745; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; }
    h2 { text-align: center; }
    #totalPrice { font-weight: bold; color: #007bff; text-align: center; }
    .note { color: red; font-size: 0.9em; text-align: center; }
  </style>
</head>
<body>

<h2>📦 نموذج طلب إطار</h2>
<form id="orderForm">
  <input type="text" name="fullName" placeholder="الاسم واللقب" required>
  <input type="tel" name="phone" placeholder="رقم الهاتف" required>
  <input type="text" name="tireType" placeholder="نوع الإطار" required>
  <input type="text" name="tireNumber" placeholder="رقم الإطار" required>
  <input type="number" name="tirePrice" placeholder="سعر الإطار (دج)" required>

  <select name="wilaya" id="wilaya" required onchange="updateDelivery()">
    <option value="">اختر الولاية</option>
  </select>

  <select id="deliveryMethod" onchange="updateDelivery()" required>
    <option value="home">🚚 إلى المنزل</option>
    <option value="office">🏢 مكتب الاستلام</option>
  </select>

  <input type="text" name="address" placeholder="العنوان الكامل" required>
  <textarea name="note" placeholder="ملاحظة (اختياري)"></textarea>
  <input type="text" name="date" readonly value="2025-06-29">

  <p id="deliveryPriceText">سعر التوصيل: - دج</p>
  <p id="totalPrice">المجموع: - دج</p>
  <p class="note">💡 ملاحظة: الوزن الزائد للعجلات يمكن أن يؤدي إلى زيادة في سعر التوصيل.</p>

  <button type="submit">إرسال الطلب</button>
</form>

<script>
// بيانات التوصيل حسب الولاية ونوع الخدمة
const deliveryPrices = {
  "أدرار": [600, 1650], "الشلف": [600, 900], "الأغواط": [450, 850], "أم البواقي": [450, 850],
  "باتنة": [450, 850], "بجاية": [450, 850], "بسكرة": [450, 850], "بشار": [600, 1650],
  "البليدة": [450, 850], "بويرة": [450, 850], "تمنراست": [800, 1650], "تبسة": [450, 850],
  "تلمسان": [600, 900], "تيارت": [450, 850], "تيزي وزو": [450, 850], "الجزائر": [450, 850],
  "الجلفة": [450, 850], "جيجل": [450, 850], "سطيف": [450, 850], "صيدا": [450, 850],
  "سكيكدة": [450, 850], "سيدي بلعباس": [500, 900], "عنابة": [450, 850], "قالمة": [450, 850],
  "قسطنطين": [450, 850], "ميديا": [450, 850], "مستغانم": [450, 900], "مسيلة": [450, 850],
  "ماسكارا": [500, 900], "ورقلة": [450, 650], "وهران": [450, 900], "البيض": [500, 850],
  "إليزي": [500, 1000], "برج بوعريريج": [450, 850], "بومرداس": [500, 900], "الطارف": [800, 900],
  "تندوف": [800, 1650], "تيسمسيلت": [450, 850], "الواد": [450, 650], "خنشلة": [450, 850],
  "سوق أهراس": [450, 850], "تيبازة": [500, 900], "ميلا": [450, 750], "عين الدفلى": [600, 900],
  "نعمة": [600, 900], "عين تموشنت": [500, 900], "غرداية": [450, 850], "غليزان": [500, 900],
  "تيميمون": [500, 900], "برج باجي مختار": [1000, 2000], "أولاد جلال": [450, 850],
  "بني عباس": [850, 1650], "في صلاح": [850, 1650], "في قزام": [700, 1400], "تقرت": [300, 500],
  "جانت": [1200, 2000], "المغير": [450, 600], "المنيعة": [500, 850]
};

const wilayaSelect = document.getElementById("wilaya");
for (const wilaya in deliveryPrices) {
  const opt = document.createElement("option");
  opt.value = wilaya;
  opt.textContent = wilaya;
  wilayaSelect.appendChild(opt);
}

function updateDelivery() {
  const wilaya = document.getElementById("wilaya").value;
  const method = document.getElementById("deliveryMethod").value;
  const deliveryPriceText = document.getElementById("deliveryPriceText");
  const tirePrice = parseFloat(document.querySelector('[name="tirePrice"]').value) || 0;
  const totalDisplay = document.getElementById("totalPrice");

  if (deliveryPrices[wilaya]) {
    const price = method === "home" ? deliveryPrices[wilaya][0] : deliveryPrices[wilaya][1];
    deliveryPriceText.textContent = "سعر التوصيل: " + price + " دج";
    totalDisplay.textContent = "المجموع: " + (price + tirePrice) + " دج";
  } else {
    deliveryPriceText.textContent = "سعر التوصيل: - دج";
    totalDisplay.textContent = "المجموع: - دج";
  }
}

document.getElementById("orderForm").addEventListener("submit", function(e) {
  e.preventDefault();
  const form = e.target;
  const data = Object.fromEntries(new FormData(form).entries());
  data.deliveryMethod = document.getElementById("deliveryMethod").value;
  const wilaya = data.wilaya;
  const price = deliveryPrices[wilaya]
    ? (data.deliveryMethod === "home" ? deliveryPrices[wilaya][0] : deliveryPrices[wilaya][1])
    : 0;
  data.deliveryPrice = price;
  data.total = parseInt(data.tirePrice || 0) + price;

  fetch("https://script.google.com/macros/s/AKfycbxqp60trG92_iwLu9W0ckOx0JG9zPzxJ4MuIakoRKegcb3kmvFYBmitxrRG5XrLUSM/exec", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(resp => alert("✅ تم إرسال الطلب بنجاح"))
  .catch(err => alert("❌ فشل في إرسال الطلب"));
});
</script>
<script>
window.onload = function () {
  const url = new URL(window.location.href);
  const number = url.searchParams.get("number");
  const brand = url.searchParams.get("brand");
  const price = url.searchParams.get("price");

  if (number) document.querySelector('[name="tireNumber"]').value = number;
  if (brand) document.querySelector('[name="tireType"]').value = brand;
  if (price) document.querySelector('[name="tirePrice"]').value = price;
}
</script>
</body>
</html>
